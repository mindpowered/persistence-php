<?php
/**
 * Generated by Haxe 4.1.1
 */

namespace persistence;

use \maglev\MagLevString;
use \php\_Boot\HxAnon;
use \maglev\MagLevFunction;
use \maglev\MagLevNull;
use \php\Boot;
use \haxe\Exception;
use \maglev\MagLevResult;
use \persistence\_Persistence\Mutator;
use \maglev\MagLevAny;
use \persistence\_Persistence\Getter;
use \maglev\MagLev;
use \maglev\MagLevBoolean;
use \php\_Boot\HxClosure;
use \haxe\ds\StringMap;
use \maglev\MagLevArray;

/**
 * Persistence
 */
class Persistence {

	/**
	 * @var StringMap
	 */
	public $getters;
	/**
	 * @var MagLev
	 */
	public $maglev;
	/**
	 * @var StringMap
	 */
	public $mutators;

	/**
	 * @param MagLev $bus
	 * 
	 * @return void
	 */
	public function __construct ($bus) {
		#/src/persistence/Persistence.hx:18: lines 18-76
		$_gthis = $this;
		#/src/persistence/Persistence.hx:19: characters 3-40
		$this->mutators = new StringMap();
		#/src/persistence/Persistence.hx:20: characters 3-38
		$this->getters = new StringMap();
		#/src/persistence/Persistence.hx:21: characters 3-20
		$this->maglev = $bus;
		#/src/persistence/Persistence.hx:22: lines 22-36
		$this->maglev->register("Persistence.AddMutator", MagLevFunction::fromFunction(function ($args) use (&$_gthis) {
			#/src/persistence/Persistence.hx:23: characters 4-72
			$recordType = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(0)))->getString();
			#/src/persistence/Persistence.hx:24: characters 4-75
			$operationName = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(1)))->getString();
			#/src/persistence/Persistence.hx:25: characters 4-56
			$strategyMethod = $_gthis->convertToHaxe($args->get(2));
			#/src/persistence/Persistence.hx:26: characters 4-32
			$updateMapper = null;
			#/src/persistence/Persistence.hx:27: lines 27-29
			if ($args->size() > 3) {
				#/src/persistence/Persistence.hx:28: characters 5-46
				$updateMapper = $_gthis->convertToHaxe($args->get(3));
			}
			#/src/persistence/Persistence.hx:30: characters 4-48
			$useRecordDataAsParams = null;
			#/src/persistence/Persistence.hx:31: lines 31-33
			if ($args->size() > 4) {
				#/src/persistence/Persistence.hx:32: characters 5-55
				$useRecordDataAsParams = $_gthis->convertToHaxe($args->get(4));
			}
			#/src/persistence/Persistence.hx:34: characters 4-99
			$_gthis->addMutator($recordType, $operationName, $strategyMethod, $updateMapper, $useRecordDataAsParams);
			#/src/persistence/Persistence.hx:35: characters 4-64
			return MagLevResult::fromResult(MagLevBoolean::fromBool(true));
		}));
		#/src/persistence/Persistence.hx:37: lines 37-55
		$this->maglev->register("Persistence.AddGetter", MagLevFunction::fromFunction(function ($args) use (&$_gthis) {
			#/src/persistence/Persistence.hx:38: characters 4-72
			$recordType = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(0)))->getString();
			#/src/persistence/Persistence.hx:39: characters 4-75
			$operationName = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(1)))->getString();
			#/src/persistence/Persistence.hx:40: characters 4-56
			$strategyMethod = $_gthis->convertToHaxe($args->get(2));
			#/src/persistence/Persistence.hx:41: characters 4-31
			$queryMapper = null;
			#/src/persistence/Persistence.hx:42: lines 42-44
			if ($args->size() >= 4) {
				#/src/persistence/Persistence.hx:43: characters 5-45
				$queryMapper = $_gthis->convertToHaxe($args->get(3));
			}
			#/src/persistence/Persistence.hx:45: characters 4-32
			$resultMapper = null;
			#/src/persistence/Persistence.hx:46: lines 46-48
			if ($args->size() >= 5) {
				#/src/persistence/Persistence.hx:47: characters 5-46
				$resultMapper = $_gthis->convertToHaxe($args->get(4));
			}
			#/src/persistence/Persistence.hx:49: characters 4-49
			$useQueryValuesAsParams = null;
			#/src/persistence/Persistence.hx:50: lines 50-52
			if ($args->size() >= 6) {
				#/src/persistence/Persistence.hx:51: characters 5-72
				$useQueryValuesAsParams = (Boot::typedCast(Boot::getClass(MagLevBoolean::class), $args->get(5)))->getBool();
			}
			#/src/persistence/Persistence.hx:53: characters 4-112
			$_gthis->addGetter($recordType, $operationName, $strategyMethod, $queryMapper, $resultMapper, $useQueryValuesAsParams);
			#/src/persistence/Persistence.hx:54: characters 4-64
			return MagLevResult::fromResult(MagLevBoolean::fromBool(true));
		}));
		#/src/persistence/Persistence.hx:56: lines 56-65
		$this->maglev->register("Persistence.Mutate", MagLevFunction::fromFunction(function ($args) use (&$_gthis) {
			#/src/persistence/Persistence.hx:57: characters 4-72
			$recordType = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(0)))->getString();
			#/src/persistence/Persistence.hx:58: characters 4-75
			$operationName = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(1)))->getString();
			#/src/persistence/Persistence.hx:59: characters 4-71
			$recordData = $_gthis->convertToHaxe(Boot::typedCast(Boot::getClass(MagLevArray::class), $args->get(2)));
			#/src/persistence/Persistence.hx:60: characters 4-63
			$maglevResult = MagLevResult::createAsync();
			#/src/persistence/Persistence.hx:61: lines 61-63
			$_gthis->mutate($recordType, $operationName, $recordData, function ($haxeResult) use (&$maglevResult, &$_gthis) {
				#/src/persistence/Persistence.hx:62: characters 5-56
				$maglevResult->setResult($_gthis->convertToMagLev($haxeResult));
			});
			#/src/persistence/Persistence.hx:64: characters 4-23
			return $maglevResult;
		}));
		#/src/persistence/Persistence.hx:66: lines 66-75
		$this->maglev->register("Persistence.Get", MagLevFunction::fromFunction(function ($args) use (&$_gthis) {
			#/src/persistence/Persistence.hx:67: characters 4-72
			$recordType = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(0)))->getString();
			#/src/persistence/Persistence.hx:68: characters 4-75
			$operationName = (Boot::typedCast(Boot::getClass(MagLevString::class), $args->get(1)))->getString();
			#/src/persistence/Persistence.hx:69: characters 4-72
			$queryValues = $_gthis->convertToHaxe(Boot::typedCast(Boot::getClass(MagLevArray::class), $args->get(2)));
			#/src/persistence/Persistence.hx:70: characters 4-63
			$maglevResult = MagLevResult::createAsync();
			#/src/persistence/Persistence.hx:71: lines 71-73
			$_gthis->get($recordType, $operationName, $queryValues, function ($haxeResult) use (&$maglevResult, &$_gthis) {
				#/src/persistence/Persistence.hx:72: characters 5-56
				$maglevResult->setResult($_gthis->convertToMagLev($haxeResult));
			});
			#/src/persistence/Persistence.hx:74: characters 4-23
			return $maglevResult;
		}));
	}

	/**
	 * @param string $recordType
	 * @param string $operationName
	 * @param mixed $strategyMethod
	 * @param mixed $queryMapper
	 * @param mixed $resultMapper
	 * @param bool $useQueryValuesAsParams
	 * 
	 * @return void
	 */
	public function addGetter ($recordType, $operationName, $strategyMethod, $queryMapper = null, $resultMapper = null, $useQueryValuesAsParams = null) {
		#/src/persistence/Persistence.hx:90: lines 90-92
		if ($queryMapper === null) {
			#/src/persistence/Persistence.hx:91: characters 4-63
			$queryMapper = function ($v, $cb) {
				#/src/persistence/Persistence.hx:91: characters 55-60
				$cb($v);
			};
		}
		#/src/persistence/Persistence.hx:93: lines 93-95
		if ($resultMapper === null) {
			#/src/persistence/Persistence.hx:94: characters 4-64
			$resultMapper = function ($v, $cb) {
				#/src/persistence/Persistence.hx:94: characters 56-61
				$cb($v);
			};
		}
		#/src/persistence/Persistence.hx:96: lines 96-98
		if ($useQueryValuesAsParams === null) {
			#/src/persistence/Persistence.hx:97: characters 4-34
			$useQueryValuesAsParams = false;
		}
		#/src/persistence/Persistence.hx:99: characters 3-106
		$getter = new Getter($recordType, $strategyMethod, $queryMapper, $resultMapper, $useQueryValuesAsParams);
		#/src/persistence/Persistence.hx:100: characters 3-65
		$this1 = $this->getters;
		$k = $this->calcKey($recordType, $operationName);
		$this1->data[$k] = $getter;
	}

	/**
	 * @param string $recordType
	 * @param string $operationName
	 * @param mixed $strategyMethod
	 * @param mixed $updateMapper
	 * @param bool $useRecordDataAsParams
	 * 
	 * @return void
	 */
	public function addMutator ($recordType, $operationName, $strategyMethod, $updateMapper = null, $useRecordDataAsParams = null) {
		#/src/persistence/Persistence.hx:79: lines 79-81
		if ($updateMapper === null) {
			#/src/persistence/Persistence.hx:80: characters 4-64
			$updateMapper = function ($v, $cb) {
				#/src/persistence/Persistence.hx:80: characters 56-61
				$cb($v);
			};
		}
		#/src/persistence/Persistence.hx:82: lines 82-84
		if ($useRecordDataAsParams === null) {
			#/src/persistence/Persistence.hx:83: characters 4-33
			$useRecordDataAsParams = false;
		}
		#/src/persistence/Persistence.hx:85: characters 3-94
		$mutator = new Mutator($recordType, $strategyMethod, $updateMapper, $useRecordDataAsParams);
		#/src/persistence/Persistence.hx:86: characters 3-67
		$this1 = $this->mutators;
		$k = $this->calcKey($recordType, $operationName);
		$this1->data[$k] = $mutator;
	}

	/**
	 * @param string $recordType
	 * @param string $operationName
	 * 
	 * @return string
	 */
	public function calcKey ($recordType, $operationName) {
		#/src/persistence/Persistence.hx:137: characters 3-42
		return ($recordType??'null') . "." . ($operationName??'null');
	}

	/**
	 * @param MagLevAny $x
	 * 
	 * @return mixed
	 */
	public function convertToHaxe ($x) {
		#/src/persistence/Persistence.hx:141: characters 3-42
		return MagLevConverter::convertToHaxe($x);
	}

	/**
	 * @param mixed $x
	 * 
	 * @return MagLevAny
	 */
	public function convertToMagLev ($x) {
		#/src/persistence/Persistence.hx:145: characters 3-44
		return MagLevConverter::convertToMagLev($x);
	}

	/**
	 * @param string $recordType
	 * @param string $operationName
	 * @param mixed $queryValues
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function get ($recordType, $operationName, $queryValues, $callback) {
		#/src/persistence/Persistence.hx:119: lines 119-134
		$_gthis = $this;
		#/src/persistence/Persistence.hx:120: characters 7-62
		$this1 = $this->getters;
		#/src/persistence/Persistence.hx:120: lines 120-133
		if (array_key_exists($this->calcKey($recordType, $operationName), $this1->data)) {
			#/src/persistence/Persistence.hx:121: characters 17-70
			$this1 = $this->getters;
			$key = $this->calcKey($recordType, $operationName);
			#/src/persistence/Persistence.hx:121: characters 4-71
			$getter = ($this1->data[$key] ?? null);
			#/src/persistence/Persistence.hx:123: lines 123-129
			$this->mapQuery($getter, $queryValues, function ($mappedQueryValues) use (&$getter, &$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:124: lines 124-128
				$_gthis->query($getter, $mappedQueryValues, function ($queryResults) use (&$getter, &$_gthis, &$callback) {
					#/src/persistence/Persistence.hx:125: lines 125-127
					$_gthis->mapResults($getter, $queryResults, function ($mappedQueryValues) use (&$callback) {
						#/src/persistence/Persistence.hx:126: characters 7-34
						$callback($mappedQueryValues);
					});
				});
			});
		} else {
			#/src/persistence/Persistence.hx:132: characters 4-9
			throw Exception::thrown("the specified getter has not been added");
		}
	}

	/**
	 * @param Getter $getter
	 * @param mixed $queryValues
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function mapQuery ($getter, $queryValues, $callback) {
		#/src/persistence/Persistence.hx:202: lines 202-225
		$_gthis = $this;
		#/src/persistence/Persistence.hx:204: characters 7-45
		$f = $getter->queryMapper;
		#/src/persistence/Persistence.hx:204: lines 204-224
		if (($f instanceof \Closure) || ($f instanceof HxClosure)) {
			#/src/persistence/Persistence.hx:205: characters 4-76
			$queryMapper = $getter->queryMapper;
			#/src/persistence/Persistence.hx:206: lines 206-208
			$queryMapper($queryValues, function ($mappedQueryValues) use (&$callback) {
				#/src/persistence/Persistence.hx:207: characters 5-32
				$callback($mappedQueryValues);
			});
		} else if (is_string($getter->queryMapper)) {
			#/src/persistence/Persistence.hx:211: characters 4-48
			$queryMapper = $getter->queryMapper;
			#/src/persistence/Persistence.hx:213: characters 4-95
			$ret = $this->maglev->call($queryMapper, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev(\Array_hx::wrap([$queryValues]))));
			#/src/persistence/Persistence.hx:214: lines 214-216
			$ret->onError(function ($error) {
				#/src/persistence/Persistence.hx:215: characters 5-10
				throw Exception::thrown($error->getMessage());
			});
			#/src/persistence/Persistence.hx:217: lines 217-220
			$ret->onResult(function ($result) use (&$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:218: characters 5-36
				$callback($_gthis->convertToHaxe($result));
				#/src/persistence/Persistence.hx:219: characters 5-56
				return MagLevResult::fromResult(MagLevNull::create());
			});
		} else {
			#/src/persistence/Persistence.hx:223: characters 4-9
			throw Exception::thrown("queryMapper must be a string or function");
		}
	}

	/**
	 * @param Getter $getter
	 * @param mixed $queryResults
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function mapResults ($getter, $queryResults, $callback) {
		#/src/persistence/Persistence.hx:257: lines 257-280
		$_gthis = $this;
		#/src/persistence/Persistence.hx:259: characters 7-46
		$f = $getter->resultMapper;
		#/src/persistence/Persistence.hx:259: lines 259-279
		if (($f instanceof \Closure) || ($f instanceof HxClosure)) {
			#/src/persistence/Persistence.hx:260: characters 4-78
			$resultMapper = $getter->resultMapper;
			#/src/persistence/Persistence.hx:261: lines 261-263
			$resultMapper($queryResults, function ($mappedResults) use (&$callback) {
				#/src/persistence/Persistence.hx:262: characters 5-28
				$callback($mappedResults);
			});
		} else if (is_string($getter->resultMapper)) {
			#/src/persistence/Persistence.hx:266: characters 4-50
			$resultMapper = $getter->resultMapper;
			#/src/persistence/Persistence.hx:268: characters 4-107
			$maglev_result = $this->maglev->call($resultMapper, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev(\Array_hx::wrap([$queryResults]))));
			#/src/persistence/Persistence.hx:269: lines 269-271
			$maglev_result->onError(function ($error) {
				#/src/persistence/Persistence.hx:270: characters 5-10
				throw Exception::thrown($error->getMessage());
			});
			#/src/persistence/Persistence.hx:272: lines 272-275
			$maglev_result->onResult(function ($result) use (&$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:273: characters 5-36
				$callback($_gthis->convertToHaxe($result));
				#/src/persistence/Persistence.hx:274: characters 5-56
				return MagLevResult::fromResult(MagLevNull::create());
			});
		} else {
			#/src/persistence/Persistence.hx:278: characters 4-9
			throw Exception::thrown("resultMapper must be a string or function");
		}
	}

	/**
	 * @param Mutator $mutator
	 * @param mixed $recordData
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function mapUpdate ($mutator, $recordData, $callback) {
		#/src/persistence/Persistence.hx:148: lines 148-171
		$_gthis = $this;
		#/src/persistence/Persistence.hx:150: characters 7-47
		$f = $mutator->updateMapper;
		#/src/persistence/Persistence.hx:150: lines 150-170
		if (($f instanceof \Closure) || ($f instanceof HxClosure)) {
			#/src/persistence/Persistence.hx:151: characters 4-79
			$updateMapper = $mutator->updateMapper;
			#/src/persistence/Persistence.hx:152: lines 152-154
			$updateMapper($recordData, function ($params) use (&$callback) {
				#/src/persistence/Persistence.hx:153: characters 5-21
				$callback($params);
			});
		} else if (is_string($mutator->updateMapper)) {
			#/src/persistence/Persistence.hx:157: characters 4-51
			$updateMapper = $mutator->updateMapper;
			#/src/persistence/Persistence.hx:159: characters 4-95
			$ret = $this->maglev->call($updateMapper, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev(\Array_hx::wrap([$recordData]))));
			#/src/persistence/Persistence.hx:160: lines 160-162
			$ret->onError(function ($error) {
				#/src/persistence/Persistence.hx:161: characters 5-10
				throw Exception::thrown($error->getMessage());
			});
			#/src/persistence/Persistence.hx:163: lines 163-166
			$ret->onResult(function ($result) use (&$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:164: characters 5-36
				$callback($_gthis->convertToHaxe($result));
				#/src/persistence/Persistence.hx:165: characters 5-56
				return MagLevResult::fromResult(MagLevNull::create());
			});
		} else {
			#/src/persistence/Persistence.hx:169: characters 4-9
			throw Exception::thrown("updateMapper must be a string or function");
		}
	}

	/**
	 * @param string $recordType
	 * @param string $operationName
	 * @param mixed $recordData
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function mutate ($recordType, $operationName, $recordData, $callback) {
		#/src/persistence/Persistence.hx:103: lines 103-117
		$_gthis = $this;
		#/src/persistence/Persistence.hx:106: characters 7-63
		$this1 = $this->mutators;
		#/src/persistence/Persistence.hx:106: lines 106-116
		if (array_key_exists($this->calcKey($recordType, $operationName), $this1->data)) {
			#/src/persistence/Persistence.hx:107: characters 18-67
			$this1 = $this->mutators;
			$key = $this->calcKey($recordType, $operationName);
			#/src/persistence/Persistence.hx:107: characters 4-68
			$mutator = ($this1->data[$key] ?? null);
			#/src/persistence/Persistence.hx:108: lines 108-112
			$this->mapUpdate($mutator, $recordData, function ($mappedRecordData) use (&$_gthis, &$mutator, &$callback) {
				#/src/persistence/Persistence.hx:109: lines 109-111
				$_gthis->update($mutator, $mappedRecordData, function ($updateResults) use (&$callback) {
					#/src/persistence/Persistence.hx:110: characters 6-29
					$callback($updateResults);
				});
			});
		} else {
			#/src/persistence/Persistence.hx:115: characters 4-9
			throw Exception::thrown("the specified mutator has not been added");
		}
	}

	/**
	 * @param Getter $getter
	 * @param mixed $queryValues
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function query ($getter, $queryValues, $callback) {
		#/src/persistence/Persistence.hx:227: lines 227-255
		$_gthis = $this;
		#/src/persistence/Persistence.hx:229: characters 3-25
		$raw_result = null;
		#/src/persistence/Persistence.hx:230: characters 7-48
		$f = $getter->strategyMethod;
		#/src/persistence/Persistence.hx:230: lines 230-254
		if (($f instanceof \Closure) || ($f instanceof HxClosure)) {
			#/src/persistence/Persistence.hx:231: characters 4-82
			$strategyMethod = $getter->strategyMethod;
			#/src/persistence/Persistence.hx:232: lines 232-234
			$strategyMethod($queryValues, function ($raw_result) use (&$callback) {
				#/src/persistence/Persistence.hx:233: characters 5-25
				$callback($raw_result);
			});
		} else if (is_string($getter->strategyMethod)) {
			#/src/persistence/Persistence.hx:237: characters 4-54
			$strategyMethod = $getter->strategyMethod;
			#/src/persistence/Persistence.hx:238: characters 4-39
			$raw_maglev_result = null;
			#/src/persistence/Persistence.hx:239: lines 239-243
			if ($getter->useQueryValuesAsParams) {
				#/src/persistence/Persistence.hx:240: characters 5-113
				$raw_maglev_result = $this->maglev->call($getter->strategyMethod, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev($queryValues)));
			} else {
				#/src/persistence/Persistence.hx:242: characters 5-115
				$raw_maglev_result = $this->maglev->call($getter->strategyMethod, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev(\Array_hx::wrap([$queryValues]))));
			}
			#/src/persistence/Persistence.hx:244: lines 244-246
			$raw_maglev_result->onError(function ($error) {
				#/src/persistence/Persistence.hx:245: characters 5-10
				throw Exception::thrown($error->getMessage());
			});
			#/src/persistence/Persistence.hx:247: lines 247-250
			$raw_maglev_result->onResult(function ($result) use (&$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:248: characters 5-36
				$callback($_gthis->convertToHaxe($result));
				#/src/persistence/Persistence.hx:249: characters 5-56
				return MagLevResult::fromResult(MagLevNull::create());
			});
		} else {
			#/src/persistence/Persistence.hx:253: characters 4-9
			throw Exception::thrown("strategyMethod must be a string or function");
		}
	}

	/**
	 * @param Mutator $mutator
	 * @param mixed $recordData
	 * @param \Closure $callback
	 * 
	 * @return void
	 */
	public function update ($mutator, $recordData, $callback) {
		#/src/persistence/Persistence.hx:173: lines 173-200
		$_gthis = $this;
		#/src/persistence/Persistence.hx:175: characters 7-49
		$f = $mutator->strategyMethod;
		#/src/persistence/Persistence.hx:175: lines 175-199
		if (($f instanceof \Closure) || ($f instanceof HxClosure)) {
			#/src/persistence/Persistence.hx:176: characters 4-83
			$strategyMethod = $mutator->strategyMethod;
			#/src/persistence/Persistence.hx:177: lines 177-179
			$strategyMethod($recordData, function ($raw_result) use (&$callback) {
				#/src/persistence/Persistence.hx:178: characters 5-25
				$callback($raw_result);
			});
		} else if (is_string($mutator->strategyMethod)) {
			#/src/persistence/Persistence.hx:182: characters 4-55
			$strategyMethod = $mutator->strategyMethod;
			#/src/persistence/Persistence.hx:183: characters 4-39
			$raw_maglev_result = null;
			#/src/persistence/Persistence.hx:184: lines 184-188
			if ($mutator->useRecordDataAsParams) {
				#/src/persistence/Persistence.hx:185: characters 5-105
				$raw_maglev_result = $this->maglev->call($strategyMethod, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev($recordData)));
			} else {
				#/src/persistence/Persistence.hx:187: characters 5-107
				$raw_maglev_result = $this->maglev->call($strategyMethod, Boot::typedCast(Boot::getClass(MagLevArray::class), $this->convertToMagLev(\Array_hx::wrap([$recordData]))));
			}
			#/src/persistence/Persistence.hx:189: lines 189-191
			$raw_maglev_result->onError(function ($error) {
				#/src/persistence/Persistence.hx:190: characters 5-10
				throw Exception::thrown($error->getMessage());
			});
			#/src/persistence/Persistence.hx:192: lines 192-195
			$raw_maglev_result->onResult(function ($result) use (&$_gthis, &$callback) {
				#/src/persistence/Persistence.hx:193: characters 5-36
				$callback($_gthis->convertToHaxe($result));
				#/src/persistence/Persistence.hx:194: characters 5-56
				return MagLevResult::fromResult(MagLevNull::create());
			});
		} else {
			#/src/persistence/Persistence.hx:198: characters 4-9
			throw Exception::thrown("strategyMethod must be a string or function");
		}
	}

	/**
	 * @internal
	 * @access private
	 */
	static public function __hx__init ()
	{
		static $called = false;
		if ($called) return;
		$called = true;


	}
}

Boot::registerClass(Persistence::class, 'persistence.Persistence');
Boot::registerMeta(Persistence::class, new HxAnon(["obj" => new HxAnon(["SuppressWarnings" => \Array_hx::wrap([\Array_hx::wrap([
	"checkstyle:FieldDocComment",
	"checkstyle:LocalVariableName",
	"checkstyle:MultipleStringLiterals",
	"checkstyle:MagicNumber",
])])])]));
Persistence::__hx__init();
